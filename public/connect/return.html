<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Complete - CrowdFuel</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center">
            <div class="mb-6">
                <svg class="w-20 h-20 mx-auto text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </div>
            
            <h1 class="text-3xl font-bold text-gray-900 mb-4">All Set!</h1>
            <p class="text-lg text-gray-600 mb-8">
                Your bank account has been connected successfully. You're ready to start receiving payouts!
            </p>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <p class="text-sm text-blue-800">
                    <strong>Next Steps:</strong><br>
                    Return to the CrowdFuel app to start creating gigs and receiving tips!
                </p>
            </div>
            
            <button onclick="window.close()" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition">
                Close & Return to App
            </button>
            
            <p class="text-xs text-gray-500 mt-4">
                You can close this window and return to the app
            </p>
        </div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBqVc8fY3gH2jK4lM5nO6pQ7rS8tU9vW0x",
            authDomain: "crowdfuel-86c2b.firebaseapp.com",
            projectId: "crowdfuel-86c2b",
            storageBucket: "crowdfuel-86c2b.firebasestorage.app",
            messagingSenderId: "1058572688549",
            appId: "1:1058572688549:ios:8f0e9b7c6d5a4f3e2b1c0d"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Get parameters from URL
        const urlParams = new URLSearchParams(window.location.search);
        const accountId = urlParams.get('accountId');
        const bandId = urlParams.get('bandId');

        // Save Stripe account ID to Firestore
        if (accountId && bandId) {
            db.collection('bands').doc(bandId).update({
                stripeAccountId: accountId,
                stripeAccountStatus: 'pending',
                stripeDetailsSubmitted: true
            }).then(() => {
                console.log('âœ… Stripe account ID saved to Firestore');
            }).catch((error) => {
                console.error('Error saving account ID:', error);
            });
        }

        // Auto-close after 3 seconds
        setTimeout(() => {
            window.close();
        }, 3000);
    </script>
</body>
</html>

